<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Producto - Tecnolog√≠a solar para Cuba</title>

  <link rel="icon" href="favicon.png" type="image/png">
  <link id="theme-style" rel="stylesheet" href="assets/css/style-day.css">
</head>

<body>

  <!-- TOP BAR / MENU -->
  <header class="topbar">
    <div class="logo">
      <a href="index.html">
        <img src="logo.png" alt="SolarCity logo" style="height:80px;">
      </a>
    </div>

    <nav>
      <a href="categoria.html?cat=powerbanks">Powerbanks</a>
      <a href="categoria.html?cat=paneles">Paneles</a>
      <a href="categoria.html?cat=luces">Luces</a>
      <a href="categoria.html?cat=sistemas">Sistemas</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>

  <main class="contenido">
    <div id="detalle-producto"></div>

    <!-- CATEGORY GRID -->
    <section class="categorias">
      <h2>Categor√≠as</h2>

      <div class="grid">
        <a class="card" href="paneles.html">Paneles</a>
        <a class="card" href="powerbanks.html">Powerbanks</a>
        <a class="card" href="luces.html">Luces</a>
        <a class="card" href="sistemas.html">Sistemas</a>
      </div>
    </section>
  </main>

  <footer>
    <p><a href="admin/login.html">Admin</a> ¬© 2026 Tecnolog√≠a Solar para el Caribe</p>
  </footer>

  <script>
    // ---------------------------------------------------------
    // 1) Z√çSK√ÅN√ç SLUGU Z URL
    // ---------------------------------------------------------
    const slug = new URLSearchParams(window.location.search).get("slug");

    // ---------------------------------------------------------
    // 2) NAƒåTEN√ç PRODUKTU PODLE SLUGU
    // ---------------------------------------------------------
    async function nactiDetailProduktu() {
      const apiUrl = "https://api.github.com/repos/czepepe-dev/solarcity/contents/data/productos";
      const files = await fetch(apiUrl).then(r => r.json());

      let jsonFiles = files
        .filter(f => f.name.endsWith(".json"))
        .map(f => f.name);

      for (const file of jsonFiles) {
        const data = await fetch(`/data/productos/${file}`).then(r => r.json());

        // pokud produkt nem√° slug ‚Üí vytvo≈ô√≠me ho z n√°zvu
        if (!data.slug) {
          data.slug = data.nombre
            .toLowerCase()
            .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
            .replace(/[^a-z0-9]+/g, "-")
            .replace(/^-+|-+$/g, "");
        }

        // üî• NALEZEN√ç PRODUKTU PODLE SLUGU
        if (data.slug === slug) {
          zobrazProdukt(data);
          return;
        }
      }

      document.getElementById("detalle-producto").innerHTML =
        "<p>Producto no encontrado.</p>";
    }

    // ---------------------------------------------------------
    // 3) VYKRESLEN√ç DETAILU PRODUKTU
    // ---------------------------------------------------------
    function zobrazProdukt(p) {
      document.getElementById("detalle-producto").innerHTML = `
        <div class="produkt-detail">
          <img src="${p.imagen}" alt="${p.nombre}" class="produkt-detail-img">

          <h1>${p.nombre}</h1>
          <div class="produkt-detail-cena">${p.precio}</div>

          <div class="produkt-detail-popis">
            ${p.descripcion}
          </div>

          <button class="produkt-btn" onclick="window.location.href='contacto.html'">
            ORDENAR
          </button>
        </div>
      `;
    }

    // ---------------------------------------------------------
    // 4) SPU≈†TƒöN√ç
    // ---------------------------------------------------------
    nactiDetailProduktu();
  </script>

</body>
</html>
